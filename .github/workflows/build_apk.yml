- name: Build APK
      env:
        ANDROID_NDK: ${{ env.ANDROID_NDK_HOME }}
        CC: ${{ env.ANDROID_NDK_HOME }}/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android24-clang
        CXX: ${{ env.ANDROID_NDK_HOME }}/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android24-clang++
      run: |
        python -m pip install flet==0.22.1
        
        # We use separate --include-packages flags to prevent the comma-parsing error
        # and ensure the environment variables are active
        flet build apk --verbose \
          --include-packages flet-audio-recorder \
          --include-packages numpy==1.25.2 \
          --include-packages opencv-python-headless==4.8.0.74